<%= page_title "Product recall tool" %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-three-quarters">
    <%= form_with model: @form, url: product_recall_path(product_id: @product.id, id: "product-details"), method: :patch, id: "recall-form", builder: ApplicationFormBuilder, html: { novalidate: true } do |form| %>
      <%= form.hidden_field :step, value: @form.step %>
      <div class="govuk-form-group image-select">
        <% if @product.virus_free_images.any? %>
          <%= form.govuk_checkboxes :product_image_ids,
                                    legend: "Select the images to include",
                                    legend_classes: "govuk-fieldset__legend govuk-fieldset__legend--l govuk-!-margin-bottom-8",
                                    items: @form.product_images(@product)
          %>
        <% else %>
          <h1 class="govuk-heading-l">
            Select the images to include
          </h1>
          <p class="govuk-body">
            Images have not been added to the <abbr title="Product Safety Database">PSD</abbr> product record.
          </p>
          <p class="govuk-body">
            You can add images to the product record, or <%= link_to "skip this page", product_recall_path(product_id: @product.id, id: "product-details"), class: "govuk-link govuk-link--no-visited-state" %>.
          </p>
        <% end %>
      </div>
      <div class="govuk-button-group">
        <%= form.submit "Continue", class: "govuk-button", role: "button" unless @form.last_step? %>
        <%= link_to "Skip", product_recall_path(product_id: @product.id, id: "product-details"), class: "govuk-link govuk-link--no-visited-state" %>
      </div>
    <% end %>
  </div>
</div>
