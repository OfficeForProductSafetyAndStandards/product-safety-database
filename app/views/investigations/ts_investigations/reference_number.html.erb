<% page_heading = "Do you want to add a reference number?" %>
<%= page_title page_heading, errors: @reference_number_form.errors.any? %>

<%= govukBackLink(
  text: "Back",
  href: wizard_path(:reason_for_creating)
) %>

<%= form_with scope: :investigation, model: @reference_number_form, url: wizard_path, method: :put, local: true do |form| %>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds-from-desktop">
      <%= govukErrorSummary form: form %>

      <span class="govuk-caption-l">Reporting an unsafe product</span>

      <h1 class="govuk-heading-l"><%= page_heading %></h1>

      <p class="govuk-body">
        The Product Safety Database assigns each case an ID.
      </p>

      <p class="govuk-body">
        However, if you've recorded information about this case in your own system, you may have given it an internal reference number. You can also add that here and it will show up if you search for it.
      </p>

      <% existing_reference_field_html = capture do %>
        <%= govukInput(
          key: :complainant_reference,
          form: form,
          label: { text: "Reference number" }
        ) %>
      <% end %>

      <%= govukRadios(
        form: form,
        key: :has_complainant_reference,
        fieldset: { legend: { text: "Do you want to add a reference number?",
                             classes: "govuk-fieldset__legend--m" } },
        items: [{ text: "Yes",
                  value: true,
                  checked: @has_reference_number == "Yes",
                  conditional: { html: existing_reference_field_html } },
                { text: "No",
                  value: false }]
      ) %>

      <%= form.submit "Continue", class: "govuk-button" %>
    </div>
  </div>
<% end %>
