<%= page_title "Add a product to the case" %>
<% content_for :back_link do %>
  <%= govukBackLink text: "Back", href: investigation_products_path(@investigation) %>
<% end %>

<%= render "investigations/pages_top", investigation: @investigation %>

<%= error_summary @find_product_form.errors %>

<%= form_with model: @find_product_form, url: investigation_products_path(@investigation), html: {novalidate: true}, builder: ApplicationFormBuilder, local: true do |form| %>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <h1 class="govuk-label-wrapper">
        <label class="govuk-label govuk-label--l" for="add-product">Enter a <%= psd_abbr %> product record reference number</label>
      </h1>
      <div id="add-product-hint" class="govuk-hint">
        Each product record in the Product Safety Database (<%= psd_abbr %>) has a <%= psd_abbr %> reference number.
      </div>
    </div>
    <div class="govuk-grid-column-two-thirds">
      <details class="govuk-details govuk-!-margin-bottom-9 opss-details--sm" data-module="govuk-details">
        <summary class="govuk-details__summary">
          <span class="govuk-details__summary-text">Help with adding a product to the case</span>
        </summary>
        <div class="govuk-details__text">
          <p class="govuk-body-s">
            Use the <%= link_to "Products area", your_products_path, class: "govuk-link govuk-link--no-visited-state" %> to find a product and its product record reference number. For example, psd-301. Using an existing <%= psd_abbr %> product record to add to your case avoids the need to create a new one and highlights other cases investigating the same product.
          </p>
          <p class="govuk-body-s">
            After checking that the product does not already exist within the <%= psd_abbr %> product records, you can create a new product record (using the links provided in the Products area pages) and then use its <%= psd_abbr %> reference number to add it to your case.
          </p>
        </div>
      </details>
      <div class="govuk-form-group">
        <div class="govuk-input__wrapper">
          <div class="govuk-input__prefix" aria-hidden="true">psd-</div>
          <%= form.text_field :reference, class: "govuk-input govuk-input--width-5", aria: { describedby: "add-product-hint" }, spellcheck: false %>
        </div>
      </div>
      <div class="govuk-button-group">
        <button class="govuk-button" data-module="govuk-button">
          Continue
        </button>
        <%= link_to "Cancel", investigation_products_path(@investigation), class: "govuk-link govuk-link--no-visited-state" %>
      </div>
    </div>
  </div>
<% end %>
