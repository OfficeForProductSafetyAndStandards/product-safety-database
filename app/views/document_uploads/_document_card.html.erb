<%
  safe = @document_upload.file_upload.metadata["safe"]
  analyzed = @document_upload.file_upload.metadata["analyzed"]
  document = @document_upload.decorate
  heading_classes = heading_classes || "govuk-heading-m govuk-!-margin-bottom-1"
  do_not_show_edit_and_remove_links = do_not_show_edit_and_remove_links || false
%>

<div class="govuk-grid-row govuk-!-padding-bottom-6">
  <div class="govuk-grid-column-one-quarter">
    <%= render "document_uploads/document_upload_preview", document_upload: @document_upload, dimensions: [300, 200] %>
  </div>

  <div class="govuk-grid-column-three-quarters">
    <% if safe || !analyzed %>
      <h2 class="<%= heading_classes %>">
        <%= @document_upload.title %>
      </h2>
      <span class="govuk-hint govuk-!-font-size-16">
        <%= formatted_document_upload_updated_date(@document_upload) %>
      </span>

      <p class="govuk-body"><%= @document_upload.description %></p>
    <% end %>

    <% if safe %>
      <%= link_with_hidden_text_to "View #{document_upload_pretty_type_description(@document_upload)}",
         "(#{@document_upload.title}, opens in new tab)",
         @document_upload,
         class: "govuk-link app-block-link govuk-!-margin-right-3 govuk-link--no-visited-state",
         target: '_blank',
         rel: 'noopener' %>

      <% unless do_not_show_edit_and_remove_links %>
        <%= render "document_uploads/document_upload_card_links", document_upload: @document_upload, parent: @parent %>
      <% end %>
    <% elsif !analyzed %>
      <div class="govuk-warning-text govuk-!-margin-right-7 govuk-!-margin-bottom-3 opss-warning-text--s">
        <span class="govuk-warning-text__icon" aria-hidden="true">!</span>

        <strong class="govuk-warning-text__text">
            <span class="govuk-warning-text__assistive">Warning</span>
            The file did not finish uploading - this may take several minutes or more. Refresh the file to confirm that the upload process has completed.
        </strong>
      </div>

      <%= link_with_hidden_text_to "Refresh the #{document_upload_pretty_type_description(@document_upload)}",
         "#{@document_upload.title}",
         "",
         class: "govuk-button govuk-button--secondary opss-button-refresh",
         "role" => "button"
      %>
    <% end %>
  </div>
</div>
