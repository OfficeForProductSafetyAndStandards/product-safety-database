<% page_heading = @corrective_action.summary %>
<% page_title page_heading %>

<% content_for :back_link do %>
  <%= govukBackLink(
    text: "Back",
    href: investigation_action_path(@investigation, @corrective_action)
  ) %>
<% end %>

<%= render "investigations/pages_top", investigation: @investigation %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds-from-desktop">
    <%= form_with model: @corrective_action.object, scope: :corrective_action, url: investigation_action_path(@investigation, @corrective_action) do |form| %>
      <%= render "form_components/govuk_error_summary", form: form %>
      <%= render "investigations/record_corrective_actions/form",
                 form: form,
                 allow_product_linking: true,
                 allow_business_linking: true,
                 corrective_action: @corrective_action,
                 investigation: @investigation
      %>
      <%= render partial: "related_attachment_fields", collection: @corrective_action.documents_blobs, as: :file_blob, locals: { form: form, file_blob: @file_blob, attachment_name: :file } %>
      <%= govukButton text: "Update corrective action" %>
    <% end %>
  </div>
</div>
